<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Barkod Yazdır</title>

<style>
  body {
    margin: 0;
    padding: 10px;
    text-align: center;
  }
  #barcode {
    width: 300px;
    height: 300px;
  }
</style>

</head>
<body>

<img id="barcode" />

<script>
  window.showBarcode = function(base64){
    const img = new Image();
    img.src = "data:image/png;base64," + base64;

    img.onload = () => {

      // Canvas oluştur
      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");

      // 100x100 mm ≈ 800x800px @203 DPI
      const cropSize = 800;
      const x = (img.width - cropSize) / 2;
      const y = (img.height - cropSize) / 2;

      canvas.width = cropSize;
      canvas.height = cropSize;

      // Orta kare crop
      ctx.drawImage(img, x, y, cropSize, cropSize, 0, 0, cropSize, cropSize);

      // Croplanmış resmi göster
      document.getElementById("barcode").src = canvas.toDataURL("image/png");

      // Print + Close
      setTimeout(() => {
        window.print();
        setTimeout(() => window.close(), 500);
      }, 200);
    };
  };
</script>

</body>
</html>
